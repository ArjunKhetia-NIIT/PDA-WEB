{% extends 'core/base.html' %}
{% load static %}
{% load custom_tags %}
{% load qr_code %}

{% block styles %}
<link rel="stylesheet" href="{% static 'css/entity-profile.css' %}" type="text/css">
<link rel="stylesheet" href="{% static 'tables.css' %}" type="text/css">
<link rel="stylesheet" href="{% static 'custom.css' %}" type="text/css">
{% endblock %}

{% block content %}
<!-- header -->

{% include 'core/header.html' %}

<div class="container-fluid entity-profile-container">
            <div class="row" style="height:157px;    margin: 30px 2px 0 -15px;">
                <!-- <div> -->
                    <input type="hidden" id="entityDetailId" value="{{entity.id}}">
                    <div class="col-md-12 head-card" style="float: left;">
                        <div class="col-md-4 box org-name-card border-line" >
                            <div class="organization-name">{{ entity.name }}</div>
                        </div>
                        <div class="col-md-2 text-center box registration-number-div border-line">
                            <div class="vert-line-hard-card card-divider"></div>
                            <div class="reg-no-heading">Business Reg. No.</div>
                            <div class="reg-no" title="{{ entity.business_registration_number }}">{{ entity.business_registration_number|truncatechars:10 }}</div>
                            <div class="reg-no-heading tax">Tax Reg. No.</div>
                            <div class="reg-no" title="{{ entity.tax_registration_number }}">{{ entity.tax_registration_number|truncatechars:10 }}</div>
                        </div>
                        <div class="col-md-4 box two border-line">
                            <div class="vert-line-hard-card" style="right:63%;"></div>
                            <div class="left">
                                <div class="address-heading">Address</div>
                                <div class="address-line1">Address line 1</div>
                                <div class="address" title="{{ entity.address_line1 }}">{{ entity.address_line1|truncatechars:12 }}</div>
                                <div class="address-line1">Address line 2</div>
                                <div class="address" title="{{ entity.address_line2 }}">{{ entity.address_line2|truncatechars:12 }}</div>
                            </div>
                            <div class="middle">
                                <div class="city">City</div>
                                <div class="content" title="{{ entity.city }}">{{ entity.city|truncatechars:15 }}</div>
                                <div class="state">State</div>
                                <div class="content" title="{{ entity.state }}">{{ entity.state|truncatechars:15 }}</div>
                            </div>
                            <div class="right">
                                <div class="city">Country</div>
                                <div class="content" title="{{ entity.country }}">{{ entity.country|truncatechars:15 }}</div>
                                <div class="pin-code">Pin/Zip Code</div>
                                <div class="content" title="{{ entity.pin_code }}">{{ entity.pin_code|truncatechars:15 }}</div>
                            </div>
                        </div>
                        <div class="col-md-2 text-center box three">
                            <div class="vert-line-hard-card"></div>
                            <div class="d-flex align-items-center">
                            <div class="align-items-center" style="display:inline-block;margin-right: 12px;margin-left:31px;">
                                <a href="#" id="downloadQR{{ entity.id }}" onclick="downloadEntityQR({{ entity.id }})">
                                    <img  style="color:#ffffff; padding: 3px 0px 3px 0px; font-size:12px;" src="{% static 'assets/download_qr.png' %}"/>
                                </a>
                            </div>
                                <div class="d-flex align-items-center flex-column" id="EntityQRCode{{ entity.id }}">
                                    <div id="entity-detail-header" style="display:none;text-align:left;font-family:AvenirNext-DemiBold;font-size:12px;padding: 12px;padding-bottom:0;">
                                        <table>
                                            <tbody>
                                            <tr>
                                                <th scope="row" style="font-size:12px; white-space: nowrap;">Entity : &nbsp;</th>
                                                <td style="font-size:12px;">{{entity.name}}</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <div style="background-color:#666666; height: 1px;margin-top:10px;"></div>
                                    </div>
                                    <div class="qr-code">{% qr_from_text entity.id image_format="png" size=4 border=3 %}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if entity_permissions.can_activate_deactivate_entity %}
                        <div class="column" style="margin-left:8px;margin-right:4%;    display: flex;flex-direction: column;position: absolute; float: right; margin-left: 84%;">
                            {% if not entity.deleted %}
                            <input type="image" class="edit-entity" src="{% static 'assets/edit_button.png' %}" alt="Submit"
                                   style="height: 24px; width: 24px;"
                                   data-url="{% url 'edit-entity-profile' pk=entity.id %}" id="edit-entity-profile-button">
                            <input type="image" src="{% static 'assets/deactivate_button.png' %}"
                                   style="height: 24px; width: 24px; margin-top: 10px;"
                                   data-toggle="modal" data-target="#deactivate-entity" id="deactivate-entity-btn">
                            {% else %}
                            <div class="reactivate-entity" style="height: 20px; float: left;">
                               <i class="fa fa-plus" aria-hidden="true" data-toggle="modal" data-target="#reactivate-entity"
                                  style="font-size: 18px; color: green; padding: 5px; cursor: pointer;"></i>
                            </div>
                            {% endif %}
                        </div>
                    {% endif %}
            </div>

            <!-- Loader for Entity Doc Update -->
            <div class="entityLoader" id="entity-doc-loader-Image">
                <img id="entity-doc-loader-img" style="" src="{% static 'images/loader.gif' %}"/>
            </div>

        <!--Program List DT    -->
            <div class="container div-program col-12">
                <div class="row">
                    <div class="col col-lg-9 col-md-9 col-sm-8 datatable-program " style="float: left;">

                        <!-- Nav tabs -->
                        <div class="d-flex justify-content-between table-heads">
                            <ul class="nav nav-tabs" id="myTab" role="tablist">
                                <li class="nav-item active">
                                    <a id="active-tab" class="nav-link" href="#example4-tab1" aria-controls="example4-tab1" role="tab"
                                       data-toggle="tab"
                                       style="width: 127px;  height: 47px;font-size: 12px;letter-spacing: -0.05px;padding-top: 15px;font-family: 'Noto Sans',sans-serif;font-color:#666666;text-align: center;border-radius: 2px 2px 0px 0px;font-weight: normal">Active
                                        Programs</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#example4-tab2" aria-controls="example4-tab2" role="tab" data-toggle="tab"
                                       style="width: 159px;  height: 47px;font-size: 12px;letter-spacing: -0.05px;padding-top: 15px; font-family: 'Noto Sans',sans-serif;font-color:#666666;text-align: center;border-radius: 2px 2px 0px 0px;font-weight: normal">Deactivated
                                        Programs</a>
                                </li>
                            </ul>
                            <form class="form-inline md-form form-sm mt-0" id="navBarSearchForm"
                                      style="margin-left:211px !important; margin-bottom:0px !important;">
                                    <img  style="" src="{% static 'images/search.png' %}"/>
                                    <input class="form-control form-control-sm ml-3 w-75 global_filter" id="global_filter"
                                           type="text" placeholder="Search..."
                                           aria-label="Search" style="border:none;box-shadow: none;" autocomplete="off">
                                </form>
                            {% if "Admin" in request.user.roles %}
                            <button type="button" class="btn btn-light show-program-form" id="add-btn" alt="Submit"
                                    data-url="{% url 'program_create' entity.pk %}">
                                    <i class="fa fa-plus" style="margin-right:5px;"></i>
                                    Add
                            </button>
                            {% endif %}
                        </div>
                        <!--      Tab panes-->

                        <div class="tab-content" id="tabs">
                            <div role="tabpanel" class="tab-pane fade in active" id="example4-tab1">
                                <table id="activated" class="table table-striped table-bordered table-condensed" cellspacing="0"
                                       style="margin-top:0px !important;box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.15);    border-top: none;">
                                    <thead id="entiy-program-list-thead-1" style="border-bottom:none !important;">
                                    <tr id="program-list-row-1">
                                        <th class="table-th">Program name</th>
                                        <th class="table-th" style="width:15%;">Start date</th>
                                        <th class="table-th" style="width:15%;">End Date</th>
                                        <th class="table-th" style="width: 18%;">No. of sessions run</th>
                                    </tr>
                                    </thead>
                                    <tbody class="table-body">
                                    {% for program in programs %}
                                    {% if not program.deleted %}
                                    <tr class="frame" id="table-data">
                                        <td class="table-td"><a href="{% url 'program-detail' pk=program.id %}">{{ program.name }}</a>
                                        </td>
                                        <td class="table-td" >{{ program.start_date|date:"d-M-Y" }}</td>
                                        <td class="table-td">{{ program.end_date|date:"d-M-Y" }}</td>
                                        <td class="table-td" style="padding-left: 64px;">{{ program.session }}</td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}

                                    </tbody>
                                </table>
                            </div>
                            <div role="tabpanel" class="tab-pane fade" id="example4-tab2">
                                <table id="deactivated" class="table table-striped table-bordered table-condensed" cellspacing="0" style="box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.15);    border-top: none;">
                                    <thead id="entiy-program-list-thead-2" style="border-bottom:none !important;">
                                    <tr id="program-list-row-2">

                                        <th class="table-th">Program name</th>
                                        <th class="table-th" style="width:15%;">Start date</th>
                                        <th class="table-th" style="width:15%;">End Date</th>
                                        <th class="table-th" style="width:18%;">No. of sessions run</th>
                                    </tr>
                                    </thead>
                                    <tbody class="table-body">
                                    {% for program in programs %}
                                    {% if program.deleted %}
                                    <tr class="frame" id="table-data">
                                        <td class="table-td">{{ program.name }}</td>
                                        <td class="table-td">{{ program.start_date|date:"d-M-Y" }}</td>
                                        <td class="table-td">{{ program.end_date|date:"d-M-Y" }}</td>
                                        <td class="table-td" style="padding-left: 64px;">{{ program.session }}</td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- Entity Admin Panel-->
                    <div class="col-lg-3 col-md-3 col-sm-3" id="accordion">
                        <div class="members card">
                            <div class="card-header row" id="headingFour">
                                <div class="d-flex justify-content-between">
                                    <div class="mb-0">
                                        <a class="btn btn-link panel-button entity-admin-panel" data-toggle="collapse" data-target="#collapseOne"
                                                aria-expanded="true" aria-controls="collapseOne" style="padding: 2px;">
                                            Entity Administrators
                                        </a>
                                         <p class="member-count">{{ ENTITY_ADMIN_ACTIVE_COUNT }} members</p>
                                    </div>

                                    <div style="color:#ffffff;margin-right:8px;cursor:pointer;margin-top: 2px;" data-toggle="collapse" data-target="#collapseOne"
                                                aria-expanded="true" aria-controls="collapseOne">
                                    {% if "Admin" in request.user.roles or entity_permissions.can_add_activate_deactivate_entity_admin %}
                                    {% if not entity.deleted %}
                                    <div class="add-entity-admin" data-toggle="modal"
                                         data-action="ADD_ENTITY_ADMIN" data-url="{% url 'add-entity-admin' %}" style="">
                                        <div class="admins-add-button" style="margin-top:8px; color:#b9524a; text-align: center;">
                                            <i class="fa fa-plus" style="margin-right:5px;"></i>
                                            Add
                                        </div>
                                    </div>
                                    {% endif %}
                                    {% endif %}
                                        <i id="entityArrowToggle" class="fa fa-caret-up" aria-hidden="true"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="entity-admin-panel sublinks" id="entityadminlist">
                                <div class="collapse show" id="collapseOne" aria-labelledby="headingFour"
                                    data-parent="#accordion">
                                    <form class="form-inline" id="adminpanelSearchForm"
                                          style="margin-left:0px !important;color:gray;">
                                        <input class="form-control"
                                               onkeyup="SearchMembers('searchProgramAdmin', 'programMemberListPanel')"
                                               id="searchProgramAdmin"
                                               type="text" placeholder="Search" autocomplete="off"
                                               aria-label="Search"
                                               style="margin-top: 4px;height: 32px;    border-radius: 4px;box-shadow: none; width:100%;font-size:12px;"/>
                                    </form>
                                    {% for admin in ENTITY_ADMIN %}
                                    <div class="entity-member-row programMemberListPanel">
                                        {% if not admin.deactivated %}
                                        <div class="media base-header card-body member-card">
                                            {% if admin.photo == "" %}
                                            <a class="pull-left picture" style="padding-right: 10px;padding-left: 0.5px;">
                                                <img id="content" class="media-object" src="{% static 'images/images.png' %}"
                                                     alt="Media Object">
                                            </a>
                                            {% else %}
                                            <a class="pull-left  picture" style="padding-right: 10px;">
                                                <img class="media-object" id="content-image" src="{{admin.photo}}"
                                                     alt="Media Object">
                                            </a>
                                            {% endif %}
                                            {% if "Admin" in request.user.roles or entity_permissions.can_add_activate_deactivate_entity_admin %}
                                            {% if not entity.deleted %}
                                            {% if ENTITY_ADMIN_ACTIVE > 1 %}
                                            <div>
                                                <input type="image"
                                                      src="{% static 'assets/deactivate_button.png' %}"
                                                       data-toggle="modal" data-target="#deactivate-member{{ admin.userId }}"
                                                       id="trainer-deactivate"/>
                                            </div>
                                            {% endif %}
                                            {% endif %}
                                            {% endif %}
                                            <div class="media-body member-media-content d-flex align-items-center" data-toggle="modal"
                                                 data-target="#myModalQr{{ admin.userId }}">
                                                <p class="media-heading humain-media-heading admin-name">{{ admin.name }}</p>
                                            </div>
                                        </div>
                                        {% else %}
                                        <div class="media base-header card-body" style="opacity: 0.3;">
                                            {% if admin.photo == "" %}
                                            <a class="pull-left picture" style="padding-right: 10px;">
                                                <img id="content" class="media-object" src="{% static 'images/images.png' %}"
                                                     alt="Media Object">
                                            </a>
                                            {% else %}
                                            <a class="pull-left  picture" style="padding-right: 10px;">
                                                <img class="media-object" id="content-image" src="{{admin.photo}}"
                                                     alt="Media Object">
                                            </a>
                                            {% endif %}
                                            {% if "Admin" in request.user.roles or entity_permissions.can_add_activate_deactivate_entity_admin %}
                                            {% if not entity.deleted %}
                                            <div class="reactivate-admin" style="height: 20px; float: right;">
                                                <input type="image"
                                                   src="{% static 'assets/reactivate_button.png' %}"
                                                   data-toggle="modal"
                                                  data-target="#reactivate-member{{ admin.userId }}" style="font-size: 18px; color: green; padding: 5px; cursor: pointer;"/>
                                            </div>
                                            {% endif %}
                                            {% endif %}
                                            <div class="media-body member-media-content d-flex align-items-center" data-toggle="modal"
                                                 data-target="#myModalQr{{ admin.userId }}">
                                                <p class="media-heading humain-media-heading admin-name">{{ admin.name }}</p>
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>
                                    {% endfor %}
                            </div>
                         </div>
                     </div>
                        <!--    Document Panel-->
                    {% if  entity_permissions.upload_entity_level_documents %}
                    <div class="col-sm document-panel-entity" id="document-panel">
                        <div class="document-head" style="height: 45px;">
                            <div class="program-docs float-left">Entity Documents</div>
                            {% if  entity_permissions.upload_entity_level_documents %}
                            {% if not entity.deleted %}
                            <div class="add-content admins-add-button float-right" id="add-entity-document"
                                 style="margin-top:8px; padding: 0px;border-radius: 6px;margin-left: 10px; margin-right:26px; background-color: white; border: 1px solid #b4b4b4;height: 28px; width: 60px;">
                                <form hidden>
                                    {% csrf_token %}
                                </form>
                                <input type="file" id="entityFileUploader" class="file entity-doc-upload" name="attachment" style="position:absolute; width: 58px; height: 26px;"/>
                                <div style="margin-top:8px; color:#b9524a; font-size:12px; padding-left: 10px;">
                                    <i class="fa fa-plus" style="margin-right:5px;"></i>
                                    Add
                                </div>
                            </div>
                            {% endif %}
                            {% endif %}
                        </div>
                            {% for entity in contents %}
                            {% if not entity.entity_documents.all %}
                                <div class="document-body-empty">
                                    <p class="document-label">No documents uploaded for this Entity</p>
                                </div>
                            {% else %}
                                <div class="document-body">
                                    {% for document in entity.entity_documents.all %}
                                    <div class="program-document row" id="entity-document-row{{ document.id }}">
                                        <div class="document-border">
                                            <a class="document-image">
                                                {% if document.content_type == "Video" %}
                                                <img class="media-object" style="width: 24px;height:28px;"
                                                     src="{% static 'images/video_icon.png' %}"
                                                     alt="Media Object">
                                                {% endif %}
                                                {% if document.content_type == "Image" %}
                                                <img class="media-object" style="width: 24px;height:28px;"
                                                     src="{% static 'images/image_icon.png' %}"
                                                     alt="Media Object">
                                                {% endif %}
                                                {% if document.content_type == "Document" %}
                                                <img class="media-object" style="width: 24px;height:28px;"
                                                     src="{% static 'images/pdf_icon.png' %}"
                                                     alt="Media Object">
                                                {% endif %}
                                            </a>
                                        </div>
                                        <div class="program-document-view">
                                            {% if document.content_type == "Video" %}
                                                <div class="v-download" style="height: 20px; overflow: hidden;" title="{{ document.name }}">
                                                    <a href="{{ document.vimeo_url }}" target="_blank" style="color: #000000;"
                                                       class="view-image-document-panel">{{ document.name|truncatechars:35 }}</a>
                                                </div>
                                                {% else %}
                                                <div class="v-download" style="height: 20px; overflow: hidden;" title="{{ document.name }}">
                                                    <a href="{{ document.content_url }}" target="_blank" style="color: #000000;"
                                                       class="view-image-document-panel">{{ document.name|truncatechars:35 }}</a>
                                                </div>
                                                {% endif %}
                                        </div>
                                        {% if  entity_permissions.upload_entity_level_documents %}
                                        {% if not entity.deleted %}
                                        <div class="doc-delete">
                                            <input type="image" src="{% static 'assets/deactivate_button.png' %}" style="height: 14px;"
                                              data-toggle="modal" data-target="#delete-entity-document{{ document.id }}" id="delete-entity-document-btn">
                                        </div>
                                        {% endif %}
                                        {% endif %}
                                    </div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
</div>

<!--  Delete Entity Document POPUP  -->
{% for document in entity.entity_documents.all %}
<div class="modal" id="delete-entity-document{{ document.id }}" role="dialog">
    <div class="modal-dialog modal-md" id="deactivate-program-dialog">
        <div class="modal-content" id="deactivate-program-content">
            <div class="modal-header base-header" id="deactivate-program-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <p id="deactivate-program-p">Are you sure you want to Delete this Document?</p>
                <div class="document-border" style="float: left; margin-top: 5%;">
                    <a class="document-image">
                        {% if document.content_type == "Video" %}
                        <img class="media-object" style="width: 34.9px;"
                             src="{% static 'images/video_icon.png' %}"
                             alt="Media Object">
                        {% endif %}
                        {% if document.content_type == "Image" %}
                        <img class="media-object"
                             src="{% static 'images/image_icon.png' %}"
                             alt="Media Object">
                        {% endif %}
                        {% if document.content_type == "Document" %}
                        <img class="media-object"
                             src="{% static 'images/pdf_icon.png' %}"
                             alt="Media Object">
                        {% endif %}
                    </a>
                </div>
                <div class="media-body member-media-content" id="delete-program-document" style="padding-left: 12%; margin-top: 6%;">
                    <h3 class="wheel-title">{{ document.name }}</h3>
                </div>
                <div class="remove" id="deactivate-program-remove">
                    <button type="button" class="view" data-dismiss="modal" id="deactivate-program-cancel">
                        Cancel
                    </button>
                    <a href="{% url 'delete-entity-document' pk=document.id %}" id="deactivate-program-button"
                       class="session-view view" onclick="disableScreen()" style="text-align: center; font-size: 14px; padding: 0px; padding-top: 6px;">Delete Document</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<!-- popup -->
<div class="modal fade" id="modal-book">
    <div class="modal-dialog" id="create-program-dialog">
        <div class="modal-content"></div>
    </div>
</div>

<!-- popup -->
<div class="modal fade" id="modal-popup">
    <div class="modal-dialog" style="margin-top:100px;max-width:526px;max-height:357px;">
        <div class="modal-content">
        </div>
    </div>
</div>

<!-- popup -->
<div class="modal fade" id="modal-popup-admin">
    <div class="modal-dialog" style="margin-top:100px;max-width:526px;max-height:357px;">
        <div class="modal-content">
        </div>
    </div>
</div>
<!-- End popup-->

<!--  Deactivate Entity POPUP  -->
<div class="modal" id="deactivate-entity" role="dialog">
    <div class="modal-dialog modal-md" id="deactivate-entity-dialog">
        <div class="modal-content" id="deactivate-entity-content">
            <div class="modal-header deactivate-entity-header" id="deactivate-entity-header" style="display: block;">
                <button type="button" class="close" data-dismiss="modal">&times</button>
                 <b><p class="deactivate-member-title">Deactivate Entity</p></b>
                <p id="deactivate-entity-p" style="color:#ff2f52;">Are you sure you want to deactivate this entity?</p>
                <div class="media-body member-media-content" id="deactivate-program-media"
                     style="background-image: linear-gradient(to left, #fa766b, #b9524a); border-radius:5px; height: 120px;">
                    <div class="col-md-12">
                        <div class="col-md-7" style="float: left; height:100px; padding-top:15px;">
                            <h3 class="wheel-title" style="color: white;"><b>{{ entity.name }}</b></h3>
                        </div>
                        <div class="col-md-5" style="display: flow-root; padding-top: 15px;">
                            <div class="vert-line" style=""></div>
                            <h6 style="font-size:10px; color: white; margin-bottom: 0px;">Business Regitration
                                Number:</h6>
                            <p class="resource-para" style="color: white; padding-top: 0px;">
                                <b>{{ entity.business_registration_number|truncatechars:30  }}</b>
                            </p>
                            <h6 style="font-size:10px; color: white; margin-bottom: 0px;">Tax Regitration Number:</h6>
                            <p class="resource-para" style="color: white; padding-top: 0px;">
                                <b>{{ entity.tax_registration_number|truncatechars:30  }}</b>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="remove" id="deactivate-entity-remove" style="padding-top: 10px;">
                    <button type="button" class="btn btn-outline-secondar view" data-dismiss="modal" id="deactivate-entity-cancel" style="color:#b9524a;
                     margin-left:190px; text-decoration:None; background-color: white; border: none; font-size: 14px; padding-top: 5px;">
                        Cancel
                    </button>
                    <a href="{% url 'deactivate-entity' pk=entity.id %}" id="deactivate-entity-session" class="session-view view"
                       style="text-decoration:None; color:white;" onclick="disableScreen()">Deactivate
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Reactivate Entity popup-->

<div class="modal" id="reactivate-entity" role="dialog">
    <div class="modal-dialog modal-md" id="reactivate-entity-dialog">
        <div class="modal-content" id="reactivate-entity-content">
            <div class="modal-header deactivate-entity-header" id="reactivate-entity-header" style="display: block;">
                <button type="button" class="close" data-dismiss="modal">&times</button>
                 <b><p class="deactivate-member-title">Reactivate Entity</p></b>
                <p id="reactivate-entity-p" style="color:#ff2f52;">Are you sure you want to Reactivate this Entity?</p>
                <div class="media-body member-media-content" id="reactivate-program-media"
                     style="background-image: linear-gradient(to left, #fa766b, #b9524a); border-radius:5px; height: 120px;">
                    <div class="col-md-12">
                        <div class="col-md-7" style="float: left; height:100px; padding-top:15px;">
                            <h3 class="wheel-title" style="color: white;"><b>{{ entity.name }}</b></h3>
                        </div>
                        <div class="col-md-5" style="display: flow-root; padding-top: 15px;">
                            <div class="vert-line" style=""></div>
                            <h6 style="font-size:10px; color: white; margin-bottom: 0px;">Business Regitration
                                Number:</h6>
                            <p class="resource-para" style="color: white; padding-top: 0px;">
                                <b>{{ entity.business_registration_number }}</b>
                            </p>
                            <h6 style="font-size:10px; color: white; margin-bottom: 0px;">Tax Regitration Number:</h6>
                            <p class="resource-para" style="color: white; padding-top: 0px;">
                                <b>{{ entity.tax_registration_number }}</b>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="remove" id="reactivate-entity-remove" style="padding-top: 10px;">
                    <button type="button" class="btn btn-outline-secondar view" data-dismiss="modal" id="deactivate-entity-cancel" style="color:#b9524a;
                     margin-left:190px; text-decoration:None; background-color: white; border: none; font-size: 14px; padding-top: 5px;">
                        Cancel
                    </button>
                    <a href="{% url 'reactivate-entity' pk=entity.id %}" class="session-view view"
                       id="deactivate-entity-session" style="text-decoration:None; color:white;" onclick="disableScreen()">Reactivate
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

{% for member in ENTITY_ADMIN %}
<div class="modal" id="myModalQr{{member.userId}}" role="dialog">
    <div class="modal-dialog modal-sm" id="myModalQr-dialog">
        <div class="modal-content" id="myModalQr-content">
            <h4 class="media-heading humain-media-heading" id="myModalQr-heading">{{member.name}}</h4>
            <div class="media modal-media" id="myModalQr-media">
                <a class="qr_img">
                    <div id="myModalQr-qr">
                        {% qr_from_text member.encryptedUserId image_format="png" size=6 %}
                    </div>
                </a>
            </div>
            <div id="myModalQr-dismiss">
                <button type="button" class="close-qr" id="myModalQr-close" data-dismiss="modal">&times;
                </button>
            </div>
        </div>
    </div>
</div>
{% endfor %}

{% for member in ENTITY_ADMIN %}
<div class="modal" id="deactivate-member{{ member.userId }}" role="dialog">
    <div class="modal-dialog modal-md" id="deactivate-member-dialog">
        <div class="modal-content" id="deactivate-member-content">
            <div class="modal-header  base-header" id="deactivate-member-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <b><p class="deactivate-member-title">Remove Member</p></b>
                <p id="deactivate-member-p">Are you sure you want to remove this Entity Admin?</p>
                <div style="padding-top:15px;">
                    <div class="member-row-modal">
                        <div class="media">
                            {% if member.photo == "" %}
                            <a class="pull-left">
                                <img class="media-object" id="member-image" src="{% static 'images/images.png' %}"
                                     alt="Media Object">
                            </a>
                            {% else %}
                            <a class="pull-left">
                                <img class="media-object" id="member-image" src="{{member.photo}}"
                                     alt="Media Object">
                            </a>
                            {% endif %}
                            <div class="media-body member-media-content">
                                <h4 class="media-heading humain-media-heading" style="padding-left:10px;">{{member.name}}</h4>
                                <div style="line-height:20px;font-family: AvenirNext-Medium; font-size: 12px; color: #333333;padding-left: 10px;">
                                    Contact Email &nbsp;:&nbsp;
                                    <span style="font-family: AvenirNext-Regular; font-size: 12px; color: #555555;text-decoration: underline;" title="{{member.emailId}}">
                                        {{member.emailId|truncatechars:25 }}</span>
                                </div>
                                <div style="line-height:20px;font-family: AvenirNext-Medium; font-size: 12px; color: #333333;padding-left: 10px;">
                                    Contact No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;
                                    <span style="font-family: AvenirNext-Regular; font-size: 12px; color: #555555;">{{member.phoneNumber}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="remove" id="deactivate-member-remove">
                        <button type="button" class="view" data-dismiss="modal" id="deactivate-entity-cancel">
                            Cancel
                        </button>
                        <a href="{% url 'entity-admin-deactivate' pk=entity.id user_id=member.userId member_name=member.name %}"
                           class="session-view view" style="text-decoration: none;color: white;" id="deactivate-member-session" onclick="disableScreen()">REMOVE
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endfor %}

{% for member in ENTITY_ADMIN %}
<div class="modal" id="reactivate-member{{ member.userId }}" role="dialog">
    <div class="modal-dialog modal-md" id="deactivate-member-dialog">
        <div class="modal-content" id="deactivate-member-content">
            <div class="modal-header  base-header" id="deactivate-member-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <b><p class="deactivate-member-title" style="width: 160px;">Reactivate Member</p></b>
                <p id="deactivate-member-p">Are you sure you want to Reactivate this Entity Admin?</p>
                <div style="padding-top:15px;">
                    <div class="member-row-modal">
                        <div class="media">
                            {% if member.photo == "" %}
                            <a class="pull-left">
                                <img class="media-object" id="member-image" src="{% static 'images/images.png' %}"
                                     alt="Media Object">
                            </a>
                            {% else %}
                            <a class="pull-left">
                                <img class="media-object" id="member-image" src="{{member.photo}}"
                                     alt="Media Object">
                            </a>
                            {% endif %}
                            <div class="media-body member-media-content">
                                <h4 class="media-heading humain-media-heading" style="padding-left:10px;">{{member.name}}</h4>
                                <div style="line-height:20px;font-family: AvenirNext-Medium; font-size: 12px; color: #333333;padding-left: 10px;">
                                    Contact Email &nbsp;:&nbsp;
                                    <span style="font-family: AvenirNext-Regular; font-size: 12px; color: #555555;text-decoration: underline;" title="{{member.emailId}}">
                                        {{member.emailId|truncatechars:25 }}</span>
                                </div>
                                <div style="line-height:20px;font-family: AvenirNext-Medium; font-size: 12px; color: #333333;padding-left: 10px;">
                                    Contact No. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;
                                    <span style="font-family: AvenirNext-Regular; font-size: 12px; color: #555555;">{{member.phoneNumber}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="remove" id="deactivate-member-remove">
                        <button type="button" class="view" data-dismiss="modal" id="deactivate-entity-cancel">
                            Cancel
                        </button>
                        <a href="{% url 'entity-admin-reactivate' pk=entity.id user_id=member.userId admin_username=member.name %}"
                           class="session-view view" style="text-decoration: none;color: white;" id="deactivate-member-session" onclick="disableScreen()">REACTIVATE
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<style>
    input.file {
        position: relative;
        text-align: right;
        -moz-opacity:0 ;
        filter:alpha(opacity: 0);
        opacity: 0;
        z-index: 2;
    }
    .file {
        position: relative;
        text-align: right;
        -moz-opacity:0 ;
        filter:alpha(opacity: 0);
        opacity: 0;
        z-index: 2;
    }
</style>
{% endblock content %}
{% block javascript %}
<script src="{% static 'js/custom/entity.js' %}"></script>
<script src="{% static 'js/plugin.js' %}"></script>

<script>
    $(document).ready(function(){
        // Toggle plus minus icon on show hide of collapse element
        $(".collapse").on('show.bs.collapse', function(){

        	$("#entityArrowToggle").toggleClass("fa-caret-down fa-caret-up");
        }).on('hide.bs.collapse', function(){
        	$("#entityArrowToggle").toggleClass("fa-caret-up fa-caret-down");
        });
    });
</script>

<script>
    function downloadEntityQR(id){
        //var x = document.getElementById("EntityQRCode" + id).firstChild.getAttribute("src");
        //document.getElementById("downloadQR" + id).href = x;
        var qrDiv = document.getElementById("EntityQRCode" + id);
        html2canvas(qrDiv, {
         onclone: function(document) {
            var qrDivTemp = document.getElementById("EntityQRCode" + id);
            qrDivTemp.children[0].style.display = "block";
            qrDivTemp.style.cssText = "background-color: #ffffff;border: 1px solid #666666;border-radius: 4px;";
        },
        onrendered: function(canvas) {
            canvas.className = "html2canvas";
            var link = document.createElement("a");
            var qrImage = canvas.toDataURL("image/png");
            link.href = qrImage;
            link.download="QRCode" + id + ".png"
            link.click();
            delete qrDivTemp;
          },
          useCORS: true
        });
    }
</script>

<!--for multiple tabs and redirection-->

<script>
// Activated Programs tab
            function filterGlobal () {
                $('#activated, #deactivated').DataTable().search(
                    $('#global_filter').val(),
                ).draw();
            }

            $(document).ready(function(){
            $.fn.dataTable.moment( 'DD-MMM-YYYY' );
               $('#activated').DataTable({
                  "bSearchable": false,
                   info: false,
                    "autoWidth": false,
                     pagingType: "full_numbers",
                   bPaginate: $('#activated tbody tr').length>10,
                   iDisplayLength: 10,
                   lengthChange: false,
                   fixedColumns: {
                        leftColumns: 1
                 },
                 "columnDefs": [
                     //date-fields
                     {
                        "targets":[ 1,2],
                        "type": 'date'
                     },
                     { "width": "30%", "targets": 0 },
                     { "width": "17%", "targets": 1 },
                      { "width": "17%", "targets": 2 },
                      { "width": "17%", "targets": 3 },

                ],
                  language:
                        {
                            search: '', searchPlaceholder: "Search",
                            emptyTable: "<p align='center'>There are no active programs</p>",
                            paginate:
                            {
                               previous:'<i class="fa fa-angle-left">' ,
                               next: '<i class="fa fa-angle-right">',
                               first: '<i class="fa fa-angle-double-left">',
                               last: '<i class="fa fa-angle-double-right">',
                           }
                        },

            });
           $('a[data-toggle="tab"]').on('shown.bs.tab', function(e){
              $($.fn.DataTable.tables({ visible: true, api: true })).DataTable()
                 //.columns.adjust()
                //.fixedColumns().relayout();
               });
            });

            $('input.global_filter').on( 'keyup', function () {
                filterGlobal();
            });

            $('#global_filter').keypress(function (e) {
            //to prevent refresh page on enter
                   if (e.which == 13) {
                        e.preventDefault();
                   }
            });

            $('#activated').on('click', 'tbody td', function () {
                if( $(this).closest('tr').find('.table-td').length > 0){
                    window.location = $(this).closest('tr').find('td:eq(0) a').attr('href');
                }
            });

//Deactivated Programs Tab

            $(document).ready(function(){
                       $.fn.dataTable.moment( 'DD-MMM-YYYY' );
                       $('#deactivated').DataTable({
                           "bSearchable": false,
                           info: false,
                           "autoWidth": false,
                            pagingType: "full_numbers",
                           bPaginate: $('#deactivated tbody tr').length>10,
                           iDisplayLength: 10,
                           lengthChange: false,
                           fixedColumns: {
                                leftColumns: 1
                          },
                          "columnDefs": [
                                 //date-fields
                                 {
                                    "targets":[ 1,2],
                                    "type": 'date'
                                 },
                                 { "width": "30%", "targets": 0 },
                                  { "width": "17%", "targets": 1 },
                                  { "width": "17%", "targets": 2 },
                                  { "width": "17%", "targets": 3 },
                            ],
                          language:
                                {
                                    search: '', searchPlaceholder: "Search",
                                    emptyTable: "<p align='center'>There are no Inactive programs</p>",
                                    paginate:
                                    {
                                       previous:'<i class="fa fa-angle-left">' ,
                                       next: '<i class="fa fa-angle-right">',
                                       first: '<i class="fa fa-angle-double-left">',
                                       last: '<i class="fa fa-angle-double-right">',
                                   }
                                },

                    });
                   $('a[data-toggle="tab"]').on('shown.bs.tab', function(e){
                      $($.fn.DataTable.tables({ visible: true, api: true })).DataTable()
                        // .columns.adjust()
                         //.fixedColumns().relayout();
                       });

                       $('input.global_filter').on( 'keyup', function () {
                            filterGlobal();
                        });

                        $('#global_filter').keypress(function (e) {
                        //to prevent refresh page on enter
                               if (e.which == 13) {
                                    e.preventDefault();
                               }
                        });
                   });
</script>

<!--for setting default tab-->
<script>
     $(document).ready(function() {
        var abc = document.getElementById('active-tab').click();
     });
</script>

<!--For Restricting page refresh on enter in admin search-->
<script>
    $('#adminpanelSearchForm').keypress(function (e) {
    //to prevent refresh page on enter
           if (e.which == 13) {
                e.preventDefault();
           }
    });
</script>

<!--For setting auto height in admin panel-->
<script>
        $('#accordion').collapse('show').height('auto');
</script>

<!--for searching in datatables-->

<script>
// Search for Activated Programs

    function myFunction() {
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("activated");
      tr = table.getElementsByTagName("tr");
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[0];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
</script>

<!--for searching in admin panel-->
<script>
    function SearchMembers(searchInput, membersList) {
      var input, filter, list, i, txtValue;
      input = document.getElementById(searchInput);
      filter = input.value.toUpperCase();
      card = document.getElementsByClassName(membersList);
      for (i = 0; i < card.length; i++) {
        memberName = card[i].innerText;
        if (memberName != undefined) {
          txtValue = memberName;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            card[i].style.display = "block";
          } else {
            card[i].style.display = "none";
          }
        }
      }
    }

</script>

<script>
    function getCookie(c_name) {
        if(document.cookie.length > 0) {
            c_start = document.cookie.indexOf(c_name + "=");
            if(c_start != -1) {
                c_start = c_start + c_name.length + 1;
                c_end = document.cookie.indexOf(";", c_start);
                if(c_end == -1) c_end = document.cookie.length;
                return unescape(document.cookie.substring(c_start,c_end));
            }
        }
        return "";
    }

    // Upload Entity Documents
      var file = {};
      $(document).on("change", "#entityFileUploader", function (event) {
        event.preventDefault();
        event.stopImmediatePropagation();
        disableScreen();
        var entityId = document.getElementById("entityDetailId").value;
        var contentFileList = document.getElementById("entityFileUploader").files;
        for (var i = 0; i < contentFileList.length; i++) {
          file[Math.random()] = contentFileList[i];
        }
        var formData = new FormData();
        var files = Object.values(file);
        var ext = $('#entityFileUploader').val().split('.').pop().toLowerCase();
        if($.inArray(ext, ['mp4', 'mpeg', 'flv', 'png', 'jpg', 'jpeg', 'pdf', 'mov']) == -1) {
            alert('Invalid File Type! Only Files with format of mp4, mpeg, mov, flv, png, jpg, jpeg, pdf will be uploaded!!');
            file = {};
            document.getElementById("entityFileUploader").value = "";
            $('.loader-overlay').remove();
            }
        else {
            formData.append("inline[]", files[0]);
            var dataUrl = "/entities/" + entityId + "/upload-entity-doc";
            $.ajax(dataUrl, {
              beforeSend: function(xhr) {
                   xhr.setRequestHeader("X-CSRFToken", getCookie("csrftoken"));
              },
              data: formData,
              method: "POST",
              dataType: false,
              contentType: false,
              processData: false,
                })
                .done(function () {
                    file.length = 0;
                    window.location.reload();
                  })
                .fail(function () {
                    alert('Something went Wrong!!');
                    window.location.reload();
                });
            }
       });
</script>
{% endblock %}
